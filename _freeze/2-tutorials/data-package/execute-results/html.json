{
  "hash": "fb8f9c832499ccbad45de56cf6935979",
  "result": {
    "markdown": "---\ntitle: \"R data package - the GHE way\"\n---\n\n\n## Why?\n\nThis tutorial was used as a workshop for team members of the Global Health Engineering group. It is part of a greater data management strategy and covers the aspired research data publication and archiving method. \n\nThe objectives are to:\n\n- make data cite-able \n- appropriately document data\n- publish analysis-ready data prior to scientific article\n- reduce workload at the point of submission of a scientific article\n- provide opportunities for showcasing data\n- give credit to contributors that would not be a co-author of a scientific article\n- enhance reproducibility of analysis-ready data (from unprocessed raw data to tidy data)\n- allow for reproducibility of scientific article by providing data alongside code\n- provide opportunities for iterations on exploratory analysis and iterations\n- increase number of group relevant datasets that can be used for teaching computational tools\n- ...\n\nThe \"Why?\" is also covered in a talk prepared for the launch meeting of the data stewardship network at ETH Zurich. It can be accessed via the [Slides](../1-slides/) page.\n\n## Part 1 \n\n### Create a repository on GitHub \n\n1.  Decide on a name for the repository and corresponding R data package\n    - have all small letters\n    - have no spaces or dashes\n    - be a combination of two to three words\n    - identify location and/or theme/topic\n\n2.  Open <https://github.com/> and start a new repo with the following settings\n    - Public\n    - Do **not** add a README\n    - Do **not** add a .gitignore\n    - Do **not** add a LICENSE\n\n## Part 2\n\n### \n\n1. Open RStudio IDE\n\n1. Create a new project using the R Package devtools and the same name you used for the repository on GitHub\n   - File -> New Project -> New Directory -> R Package using devtools -> Choose directory name and location of sub-directory\n\n3.  Add git version control to local directory\n\n- yes, commit\n- yes, restart\n\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\nlibrary(usethis)\nuse_git()\n```\n````\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ Setting active project to '/Users/lschoebitz/Documents/gitrepos/gh-org-global-health-engineering/website'\n✔ Adding '.Rdata', '.httr-oauth', '.quarto' to '2-tutorials/.gitignore'\n```\n:::\n:::\n\n\n    - In Console, execute usethis::use_git `library(usethis)`\n        - `use_git()`\n            - yes, commit\n                - yes, restart   \n   \n**Open RStudio IDE**\n           \n\n    4.  Connect remote repository on GitHub with local repository\n        - `git remote add origin URL`\n        - `git branch -M main`\n        - `git push -u origin main`\n    5.  Add directory for raw-data to project\n        - In Console, execute\n            - `library(devtools)`\n            - `use_data_raw()`\n                - This will create a `data-raw/` subdirectory.\n                    - contains a DATASET.R file\n                        - rename to `data_processing.R`\n    6.  Add, commit and push all changes to GitHub \n    7.  On GitHub, open issue 1 for adding data to `data-raw/` folder\n        - use an issue template (example: https://github.com/openwashdata/cbssuitabilityhaiti/issues/1#issue-1657507593)\n    8.  Prepare import of data and export of tidy raw data in `data_processing.R` file\n        - ```javascript\n\nlibrary(readr)\n\nkitas <- read_csv(\"data-raw/kennzahlen_kitas_seit2006.csv\")\n\n## code to prepare `DATASET` dataset goes here\n\nusethis::use_data(kitas, overwrite = TRUE)\n```\n    9.  Add, commit and push all changes to GitHub \n    10.  Add `dictionary.csv` to `data-raw/` with columns:\n        - directory, file_name, variable_name, variable_type, description\n    11.  Once data reaches tidy state, fill `dictionary.csv` for each dataset and variable \n    12.   On GitHub, open issue 3 for cross-checking in with data donator for correct understanding of variables in  `dictionary.csv`\n    13.  Initiate documentation folder for writing up metadata and documentation for objects\n        - Create new folder R\n            - `usethis::use_r`\n    14.  Install openwashdata R package\n        - `devtools::install_github(\"openwashdata/openwashdata\")`\n    15.  Write documentation in `\\R` folder using #[[{roxygen}]] comments\n        - ```javascript\nopenwashdata::generate_roxygen_docs(\n  input_file_path = \"data-raw/dictionary.csv\", \n  output_file_path = \"R/kitas.R\")```\n        - Include a title\n        - Include a description\n        - Write a source\n            - ```javascript\n#' @source <https://data.stadt-zuerich.ch/dataset/sd_zv_kitas_kennzahlen>```\n        - If `dictionary.csv` is complete use function `generate_roxygen_docs` of [[{openwashdata}]] R package to document variables\n            - https://github.com/openwashdata/openwashdata/blob/main/R/generate_roxygen_docs.R\n        - Example\n            - https://github.com/Global-Health-Engineering/durbanplasticwaste22/blob/main/R/litterboom_counts.R\n            - Object has to be quoted at the end of roxygen comments\n        - Resource\n            - https://r-pkgs.org/data.html#sec-documenting-data\n    16.  Add, commit and push all changes to GitHub \n        - On GitHub, setup issue 4 with details to write up  `DESCRIPTION` file\n            - Template\n            - List\n                -  Title \n                    - make this title short, not the title of the thesis\n                -  Description\n                    - Brief and to the point describing what's in the data\n                -  Contributors (name, email, role, ORCID)\n                    - Include everyone here\n                    - Roles\n                        - cre = maintainer\n                        - aut = significant contributions\n                        - ctb = contributor with smaller contributios\n            - Resource\n                - https://r-pkgs.org/description.html\n    17.  Complete `DESCRIPTION` file\n        - Add author\n            - ```javascript\nuse_author(\n  given = \"Lars\",\n  family = \"Schöbitz\",\n  role = c(\"aut\", \"cre\"),\n  email = \"lschoebitz(at)ethz.ch\",\n  comment = c(ORCID = \"0000-0003-2196-5015\")\n)```\n            - Roles\n                - cre = maintainer\n                - aut = significant contributions\n                - ctb = contributor with smaller contributios\n        - Add license\n            - `usethis::use_cc_by()`\n    18.  Add, commit and push all changes to GitHub \n    19.  Use `devtools` to load, document, check, and install\n        - Use keyboard shortcuts\n            - `devtools::load_all()` \"Cmd + Shift + L\"\n            - `devtools::document()` \"Cmd + Shift + D\"\n            - `devtools::check()` \"Cmd + Shift + E\"\n            - `devtools::install()` \"Cmd + Shift + B\"\n    20.  Add `CITATION.cff` \n        - ```javascript\nlibrary(cffr)\ncff_write()```\n        - use the [[{cffr}]] Package once the Description file is complete\n        - current #gist to be turned into function for [[{openwashdata}]] R package\n            - https://gist.github.com/larnsce/dccdb26762837618c6dda82a5614b584\n            - needs doi paramater, which will only be used after first release to Zenodo\n    21.  Add, commit and push all changes to GitHub \n    22.  Create a rmd README for package\n        - `usethis::use_readme_rmd()`\n            - Outline template\n                - ```javascript\nreadr::read_csv(\"data-raw/dictionary.csv\") |> \n  dplyr::select(variable_name:description) |> \n  gt::gt()```\n                - https://github.com/Global-Health-Engineering/durbanplasticwaste22/blob/main/README.Rmd\n        - `devtools::build_readme()`\n    23.  Add, commit and push all changes to GitHub \n        - On GitHub, open issue 5 to define who writes up which parts of the README\n    24.  Create an examples article for the package\n        - `usethis::use_article(\"examples\")`\n        - `devtools::build_rmd(\"vignettes/articles/examples.Rmd\")`\n        - Resources\n            - https://r-pkgs.org/vignettes.html#sec-vignettes-workflow-writing\n        - Prepare one or two data visualisation or table examples\n    19.  Use `devtools` to load, document, check, and install\n        - Use keyboard shortcuts\n            - `devtools::load_all()` \"Cmd + Shift + L\"\n            - `devtools::document()` \"Cmd + Shift + D\"\n            - `devtools::check()` \"Cmd + Shift + E\"\n            - `devtools::install()` \"Cmd + Shift + B\"\n        - `usethis::use_github_action_check_standard()?`\n            - checks build for Mac, Windows, Linux\n    26.  Setup pkgdown configuration and github actions\n        - `usethis::use_pkgdown`\n        - open `_pkgdown.yml`\n            -  add github pages URL\n            -  add plausible script (plausible for openwashdata to be setup)\n                - template:\n                    - bootstrap: 5\n                    - includes:\n                        - in_header: |\n                            - <script defer data-domain=\"global-health-engineering.github.io/durbanplasticwaste\" src=\"https://plausible.io/js/script.js\"></script>\n    27.  Build pkgdown website\n        - `pkgdown::build_site()`\n    28.  Add, commit and push all changes to GitHub \n    29.  Edit Home Index\n        - use this as template: https://github.com/Global-Health-Engineering/durbanplasticwaste/blob/main/_pkgdown.yml\n            - consider writing pkgdown template for this: https://github.com/openwashdata/book/issues/16\n                - https://github.com/tidyverse/tidytemplate\n        - https://pkgdown.r-lib.org/articles/pkgdown.html#home-page\n        - explore: https://pkgdown.r-lib.org/articles/customise.html\n- **Open GitHub**\n    - Publish as GitHub Pages\n- **Open Zenodo**\n    -  login with GitHub account\n    -  click on dropdown next to email address in top right\n        - select GitHub\n        - find the repository in the list\n        - and flip switch to \"ON\"\n        - click on repo link\n    -  create release v0.0.1 on GitHub\n        - initial package releas\n    -  Get the DOI Badge\n    -  Edit the main page and remove text under Additional notes\n- **Open RStudio IDE**\n    -  Add DOI badge to repository README.md\n    -  Edit DESCRIPTION\n        - edit version number\n    -  Write CITATION.cff and inst/CITATION with DOI entry using #gist or respective [[{openwashdata}]] R Package\n        - https://gist.github.com/larnsce/dccdb26762837618c6dda82a5614b584\n    -  `pkgdown::build_site()`\n- **Open ETH Research Collection (not for openwashdata, but GHE workflow)**\n    - research data -> dataset\n    - organisational unit\n        - tilley\n    - license\n        - creative commons attribution 4.0 International\n- **Common items to be fixed**\n    - R CMD CHECK\n        - Notes\n            - unable to verify current time\n                - Fix: https://stackoverflow.com/a/63837547/6816220\n            - Non-standard files/directories found at top level:\n                - Fix: https://stackoverflow.com/questions/48955103/non-standard-file-directory-found-at-top-level-readme-rmd-persists-even-after\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}